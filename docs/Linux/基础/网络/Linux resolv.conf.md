# Linux resolv.conf

参考：

https://wiki.archlinux.org/index.php/Domain_name_resolution_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)

http://www.ttlsa.com/linux/resolv-conf-desc/

http://dns-learning.twnic.net.tw/bind/intro4.html

> 如果DHCP服务器，该文件会从DHCP上获取nameserver，如果需要关闭该功能修改`ifcfg-xxx`文件
>
> ```
> PEERDNS=no
> ```
>
> `/etc/resolv.conf`文件用于管理和解析domain，修改文件后无需重启network，修改后立即生效

- nameserver

  指定DNS服务器，当有多个nameserver时，按照顺序解析。如果没有设置该值，使用本机的nameserver。但是一般不超过3个，如果DNS服务器无响应需要等待时间

  ```
  [root@chz ~]# cat /etc/resolv.conf
  # Generated by NetworkManager
  nameserver 114.114.114.114
  nameserver 8.8.8.8
  ```

- domain

  指定本机的域名，仅做为search的默认值使用

- search

  在没有设置search时，search默认为domain的值，当域名不能被nameserver解析时，resolver就会在该域名后添加search参数

  可以通过空格指定多个

  ```
  [root@chz ~]# cat /etc/resolv.conf
  # Generated by NetworkManager
  search baidu.com
  nameserver 114.114.114.114
  [root@chz ~]# ping news
  PING news.n.shifen.com (180.101.49.131) 56(84) bytes of data.
  64 bytes from 180.101.49.131 (180.101.49.131): icmp_seq=1 ttl=128 time=11.3 ms
  64 bytes from 180.101.49.131 (180.101.49.131): icmp_seq=2 ttl=128 time=11.5 ms
  64 bytes from 180.101.49.131 (180.101.49.131): icmp_seq=3 ttl=128 time=11.5 ms
  
  [root@chz ~]# dig news.baidu.com
  
  ; <<>> DiG 9.11.4-P2-RedHat-9.11.4-9.P2.el7 <<>> news.baidu.com
  ;; global options: +cmd
  ;; Got answer:
  ;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 9193
  ;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 1
  
  ;; OPT PSEUDOSECTION:
  ; EDNS: version: 0, flags:; udp: 512
  ;; QUESTION SECTION:
  ;news.baidu.com.			IN	A
  
  ;; ANSWER SECTION:
  news.baidu.com.		460	IN	CNAME	news.n.shifen.com.
  news.n.shifen.com.	147	IN	A	180.101.49.131
  news.n.shifen.com.	147	IN	A	180.97.33.136
  
  ```

  

